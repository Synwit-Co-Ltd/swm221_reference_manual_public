.. ----------------------------------------------------------------------------------------------------

控制寄存器CTRL
^^^^^^^^^^^^^^^^^^^^^^

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 9 6 10 33

   * - 寄存器

     - 偏移

     - 类型

     - 复位值

     - 描述

   * - CTRL

     - 0x00

     - R/W

     - 0x009E 1172

     - SPI控制寄存器



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :widths: 9 9 9 9 9 9 9 9
   :align: center

   * - 31

     - 30

     - 29

     - 28

     - 27

     - 26

     - 25

     - 24

   * - BIDIMODE

     - BIDIOE

     - INNOSPL

     - LSBF

     - :cspan:`1` SAMPLE_DLY

     - TFCLR

     - RFCLR

   * - 23

     - 22

     - 21

     - 20

     - 19

     - 18

     - 17

     - 16

   * - :cspan:`2` TFTHR

     - :cspan:`2` RFTHR

     - SSN

     - FILTE

   * - 15

     - 14

     - 13

     - 12

     - 11

     - 10

     - 9

     - 8

   * - DMARXEN

     - DMATXEN

     - FAST

     - MSTR

     - :cspan:`1` FFS

     - CPOL

     - CPHA

   * - 7

     - 6

     - 5

     - 4

     - 3

     - 2

     - 1

     - 0

   * - :cspan:`3` SIZE

     - EN

     - :cspan:`2` CLKDIV



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 15 73

   * - 位域

     - 名称

     - 描述

   * - 31

     - BIDIMODE

     - 单线半双工模式开关

   * - 30

     - BIDIOE

     - 单线半双工模式下信号输出使能

   * - 29

     - INNOSPL

     - 输入信号不进行采样控制

       0：输入信号处理方式FILTE寄存器来控制

       1：输入信号不进行任何采样

       注：若不进行采样，则输入信号直接进行电路进行工作，可最大化的提高传输速率，但会降低可靠性。该为有效后，SPI的传输速率在理论上无论主从模式全双工还是单工，最大的传输速率可达到pclk1的2分频。


   * - 28

     - LSBF

     - LSB配置寄存器

       1：数据按照LSB发送（发送时，TX寄存器数据的bit0位会首先被发出；接收时，接收的第一个bit数据会放到RX寄存器的bit0位）

       0：数据按照MSB发送（发送时，TX寄存器数据的最高位会首先被发出；接收时，接收的第一个bit数据会放到RX寄存器的最高位）


   * - 27:26

     - SAMPLE_DLY

     - 输入采样延时选择位

       0：表示不延迟采样

       1：表示延迟一个时钟周期

       2：表示延迟两个时钟周期

       3：表示延迟三个时钟周期


   * - 25

     - TFCLR

     - 发送FIFO清除控制位

       1：发送FIFO清除有效

       0：发送FIFO清除无效


   * - 24

     - RFCLR

     - 接收FIFO清除控制位

       1：接收FIFO清除有效

       0：接收FIFO清除无效


   * - 23:21

     - TFTHR

     - 发送FIFO达到设置门限后产生中断配置位

       000：发送FIFO中最多有0个数据

       001：发送FIFO中最多有1个数据

       010：发送FIFO中最多有2个数据

       011：发送FIFO中最多有3个数据

       100：发送FIFO中最多有4个数据

       101：发送FIFO中最多有5个数据

       110：发送FIFO中最多有6个数据

       111：发送FIFO中最多有7个数据


   * - 20:18

     - RFTHR

     - 接收FIFO达到设置门限后会产生中断配置位

       000：接收FIFO中至少有1个数据

       001：接收FIFO中至少有2个数据

       010：接收FIFO中至少有3个数据

       011：接收FIFO中至少有4个数据

       100：接收FIFO中至少有5个数据

       101：接收FIFO中至少有6个数据

       110：接收FIFO中至少有7个数据

       111：接收FIFO中至少有8个数据


   * - 17

     - SSN

     - SSN在传输过程中是否出现控制位。（在数据帧为SPI模式下，并且配置主模式工作时，通过该位可控制在传输过程中每帧数据之间是否需要SSN拉高）

       0：传输过程中SSN始终为0

       1：传输过程中每一帧数据之间会将SSN至少拉高0.5个SCK周期


   * - 16

     - FILTE

     - 输入信号去抖控制

       0：对输入信号不进行去抖操作

       1：对输入信号进行去抖操作


   * - 15

     - DMARXEN

     - DAM读FIFO使能

       1：通过DMA读FIFO

       0：通过MCU读FIFO


   * - 14

     - DMATXEN

     - DAM写FIFO使能

       1：通过DMA写FIFO

       0：通过MCU写FIFO


   * - 13

     - FAST

     - 快速模式选择

       1：SPI的SCLK为pclk1的2分频

       0：SPI的SCLK由CLKDIV控制


   * - 12

     - MSTR

     - 主从模式选择

       1：SPI系统配置为主器件模式

       0：SPI系统配置为从器件模式


   * - 11:10

     - FFS

     - 数据帧格式选择

       00：SPI模式

       01：SSI模式

       10：保留

       11：保留


   * - 9

     - CPOL

     - 时钟极性选择

       0 = 串行时钟空闲状态为低电平，有效电平为高电平

       1 = 串行时钟空闲状态为高电平，有效电平为低电平


   * - 8

     - CPHA

     - 时钟相位选择

       0 = 在串行时钟的第一个跳变沿采样数据

       1 = 在串行时钟的第二个跳变沿采样数据


   * - 7:4

     - SIZE

     - 数据位数选择

       0000：保留

       0001：保留

       0010：保留

       0011：4bit数据

       0100：5bit数据

       0101：6bit数据

       0110：7bit数据

       0111：8bit数据

       1000：9bit数据

       1001：10bit数据

       1010：11bit数据

       1011：12bit数据

       1100：13bit数据

       1101：14bit数据

       1110：15bit数据

       1111：16bit数据


   * - 3

     - EN

     - SPI使能位

       0：禁止

       1：使能

       注1：该寄存器使能后，若在主模式下，当发送FIFO有数据时则开始启动数据帧传输；在从模式下，等待数据帧传输


   * - 2:0

     - CLKDIV

     - 波特率选择

       000：PCLK1 4分频

       001：PCLK1 8分频

       010：PCLK1 16分频

       011：PCLK1 32分频

       100：PCLK1 64分频

       101：PCLK1 128分频

       110：PCLK1 256分频

       111：PCLK1 512分频




.. ----------------------------------------------------------------------------------------------------

数据寄存器DATA
^^^^^^^^^^^^^^^^^^^^^^

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 9 6 10 33

   * - 寄存器

     - 偏移

     - 类型

     - 复位值

     - 描述

   * - DATA

     - 0x04

     - R/W

     - 0x0000 0000

     - SPI数据寄存器



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :widths: 9 9 9 9 9 9 9 9
   :align: center

   * - 31

     - 30

     - 29

     - 28

     - 27

     - 26

     - 25

     - 24

   * - :cspan:`7` DATA

   * - 23

     - 22

     - 21

     - 20

     - 19

     - 18

     - 17

     - 16

   * - :cspan:`7` DATA

   * - 15

     - 14

     - 13

     - 12

     - 11

     - 10

     - 9

     - 8

   * - :cspan:`7` DATA

   * - 7

     - 6

     - 5

     - 4

     - 3

     - 2

     - 1

     - 0

   * - :cspan:`7` DATA



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 15 73

   * - 位域

     - 名称

     - 描述

   * - 31:0

     - DATA

     - SPI接收/发送数据寄存器

       读操作从接收FIFO中读出接收到的数据

       写操作将数据写入发送FIFO中

       注：若数据不是32bit，则按照右对齐进行排列，高位不关心。




.. ----------------------------------------------------------------------------------------------------

状态寄存器STAT
^^^^^^^^^^^^^^^^^^^^^^

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 9 6 10 33

   * - 寄存器

     - 偏移

     - 类型

     - 复位值

     - 描述

   * - STAT

     - 0x08

     - R/W

     - 0x0001 0006

     - SPI状态寄存器



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :widths: 9 9 9 9 9 9 9 9
   :align: center

   * - 31

     - 30

     - 29

     - 28

     - 27

     - 26

     - 25

     - 24

   * - :cspan:`7` --

   * - 23

     - 22

     - 21

     - 20

     - 19

     - 18

     - 17

     - 16

   * - :cspan:`7` --

   * - 15

     - 14

     - 13

     - 12

     - 11

     - 10

     - 9

     - 8

   * - BUSY

     - :cspan:`2` --

     - :cspan:`2` RFLVL

     - TFLVL

   * - 7

     - 6

     - 5

     - 4

     - 3

     - 2

     - 1

     - 0

   * - :cspan:`1` TFLVL

     - RFOV

     - RFF

     - RFNE

     - TFNF

     - TFE

     - WTC



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 15 73

   * - 位域

     - 名称

     - 描述

   * - 31:16

     - --

     - --

   * - 15

     - BUSY

     - SPI传输忙标志位

       0：表示SPI未进行传输

       1：表示SPI正在进行传输


   * - 14:12

     - --

     - --

   * - 11:9

     - RFLVL

     - 接收FIFO数据深度位标志，RO

       000：RFF为1时，表示FIFO内有8组数据

       RFF为0时，表示FIFO内没有数据；

       001：表示FIFO内有1组数据；

       010：表示FIFO内有2组数据；

       011：表示FIFO内有3组数据；

       100：表示FIFO内有4组数据；

       101：表示FIFO内有5组数据；

       110：表示FIFO内有6组数据；

       111：表示FIFO内有7组数据；


   * - 8:6

     - TFLVL

     - 发送FIFO数据深度位标志，RO

       000：TFNF为0时，表示FIFO内有8组数据

       TFNF为1时，表示FIFO内没有数据；

       001：表示FIFO内有1组数据；

       010：表示FIFO内有2组数据；

       011：表示FIFO内有3组数据；

       100：表示FIFO内有4组数据；

       101：表示FIFO内有5组数据；

       110：表示FIFO内有6组数据；

       111：表示FIFO内有7组数据；


   * - 5

     - RFOV

     - 接收FIFO溢出标志，软件清零，写清零

       0：没溢出

       1：溢出


   * - 4

     - RFF

     - 接收FIFO满标志

       0：非满

       1：满


   * - 3

     - RFNE

     - 接收FIFO非空标志

       0：空

       1：非空


   * - 2

     - TFNF

     - 发送FIFO非满标志

       0：满

       1：非满


   * - 1

     - TFE

     - 发送FIFO空标志

       0：非空

       1：空


   * - 0

     - WTC

     - SPI数据帧传输结束标志

       每次数据帧传输结束后，该标志会被置位。

       软件清零，写1清零。




.. ----------------------------------------------------------------------------------------------------

中断使能寄存器IE
^^^^^^^^^^^^^^^^^^^^^^

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 9 6 10 33

   * - 寄存器

     - 偏移

     - 类型

     - 复位值

     - 描述

   * - IE

     - 0x0C

     - R/W

     - 0x0000 0000

     - SPI中断使能寄存器



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :widths: 9 9 9 9 9 9 9 9
   :align: center

   * - 31

     - 30

     - 29

     - 28

     - 27

     - 26

     - 25

     - 24

   * - :cspan:`7` --

   * - 23

     - 22

     - 21

     - 20

     - 19

     - 18

     - 17

     - 16

   * - :cspan:`7` --

   * - 15

     - 14

     - 13

     - 12

     - 11

     - 10

     - 9

     - 8

   * - :cspan:`3` --

     - CSRISE

     - CSFALL

     - WTC

     - FTC

   * - 7

     - 6

     - 5

     - 4

     - 3

     - 2

     - 1

     - 0

   * - --

     - TFTHR

     - RFTHR

     - TFHF

     - TFE

     - RFHF

     - RFF

     - RFOV



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 15 73

   * - 位域

     - 名称

     - 描述

   * - 31:12

     - --

     - --

   * - 11

     - CSRISE

     - 从机模式下，SSN信号上升沿检测中断使能

       1：使能

       0：不使能


   * - 10

     - CSFALL

     - 从机模式下，SSN信号下降沿检测中断使能

       1：使能

       0：不使能


   * - 9

     - WTC

     - SPI传输结束中断使能

       1：使能

       0：不使能


   * - 8

     - FTC

     - SPI数据帧传输结束中断使能

       1：使能

       0：不使能


   * - 7

     - --

     - --

   * - 6

     - TFTHR

     - 发送FIFO达到设定门限中断使能

       1：使能

       0：不使能


   * - 5

     - RFTHR

     - 接收FIFO达到设定门限中断使能

       1：使能

       0：不使能


   * - 4

     - TFHF

     - 发送FIFO半满使能

       1：使能

       0：不使能


   * - 3

     - TFE

     - 发送FIFO空中断使能

       1：使能

       0：不使能


   * - 2

     - RFHF

     - 接收FIFO半满使能

       1：使能

       0：不使能


   * - 1

     - RFF

     - 接收FIFO满中断使能

       1：使能

       0：不使能


   * - 0

     - RFOV

     - 接收FIFO溢出中断使能

       1：使能

       0：不使能




.. ----------------------------------------------------------------------------------------------------

中断状态寄存器IF
^^^^^^^^^^^^^^^^^^^^^^

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 9 6 10 33

   * - 寄存器

     - 偏移

     - 类型

     - 复位值

     - 描述

   * - IF

     - 0x10

     - R/W1C

     - 0x0000 0000

     - SPI中断状态寄存器



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :widths: 9 9 9 9 9 9 9 9
   :align: center

   * - 31

     - 30

     - 29

     - 28

     - 27

     - 26

     - 25

     - 24

   * - :cspan:`7` --

   * - 23

     - 22

     - 21

     - 20

     - 19

     - 18

     - 17

     - 16

   * - :cspan:`7` --

   * - 15

     - 14

     - 13

     - 12

     - 11

     - 10

     - 9

     - 8

   * - :cspan:`5` --

     - WTC

     - FTC

   * - 7

     - 6

     - 5

     - 4

     - 3

     - 2

     - 1

     - 0

   * - --

     - TFTHR

     - RFTHR

     - TFHF

     - TFE

     - RFHF

     - RFF

     - RFOV



.. ----------------------------------------------------------------------------------------------------

.. flat-table::
   :class: tight-table
   :header-rows: 1
   :widths: 12 15 73

   * - 位域

     - 名称

     - 描述

   * - 31:12

     - --

     - --

   * - 11

     - CSRISE

     - 从机模式SSN上升沿中断，写1清中断

       1：中断

       0：未中断


   * - 10

     - CSFALL

     - 从机模式SSN下降沿中断，写1清中断

       1：中断

       0：未中断


   * - 9

     - WTC

     - SPI传输结束中断标志，写1清中断

       1：中断

       0：未中断


   * - 8

     - FTC

     - SPI数据帧传输结束中断标志，写1清中断

       1：中断

       0：未中断


   * - 7

     - --

     - --

   * - 6

     - TFTHR

     - 发送FIFO达到设定断标志，写1清中断

       1：中断

       0：未中断


   * - 5

     - RFTHR

     - 接收FIFO达到设定门限中断标志，写1清中断

       1：中断

       0：未中断


   * - 4

     - TFHF

     - 发送FIFO半满中断标志，写1清中断

       1：中断

       0：未中断


   * - 3

     - TFE

     - 发送FIFO空中断标志，写1清中断

       1：中断

       0：未中断


   * - 2

     - RFHF

     - 接收FIFO半满中断标志，写1清中断

       1：中断

       0：未中断


   * - 1

     - RFF

     - 接收FIFO满中断标志，写1清中断

       1：中断

       0：未中断


   * - 0

     - RFOVF

     - 接收FIFO溢出中断标志，写1清中断

       1：中断

       0：未中断




